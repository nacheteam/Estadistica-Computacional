<!doctype html>
<html class="no-js" lang="en">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

    <head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
        <!-- meta data -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

        <!--font-family-->
		<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&amp;subset=devanagari,latin-ext" rel="stylesheet">

        <!-- title of site -->
        <title>Ejercicio 2</title>

        <!-- For favicon png -->
		<link rel="shortcut icon" type="image/icon" href="assets/logo/favicon.png"/>

        <!--font-awesome.min.css-->
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">

		<!--flat icon css-->
		<link rel="stylesheet" href="assets/css/flaticon.css">

		<!--animate.css-->
        <link rel="stylesheet" href="assets/css/animate.css">

        <!--owl.carousel.css-->
        <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
		<link rel="stylesheet" href="assets/css/owl.theme.default.min.css">

        <!--bootstrap.min.css-->
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">

		<!-- bootsnav -->
		<link rel="stylesheet" href="assets/css/bootsnav.css" >

        <!--style.css-->
        <link rel="stylesheet" href="assets/css/style.css">

        <!--responsive.css-->
        <link rel="stylesheet" href="assets/css/responsive.css">

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->

        <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>

	<body>
		<!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->

		<!-- top-area Start -->
		<header class="top-area">
			<div class="header-area">
				<!-- Start Navigation -->
			    <nav class="navbar navbar-default bootsnav navbar-fixed dark no-background">

			        <div class="container">

			            <!-- Start Header Navigation -->
			            <div class="navbar-header">
			                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-menu">
			                    <i class="fa fa-bars"></i>
			                </button>
			                <a class="navbar-brand" href="index.html">Ejercicio 2. Ignacio Aguilera Martos</a>
			            </div><!--/.navbar-header-->
			            <!-- End Header Navigation -->

			            <!-- Collect the nav links, forms, and other content for toggling -->
			            <div class="collapse navbar-collapse menu-ui-design" id="navbar-menu">
			                <ul class="nav navbar-nav navbar-right" data-in="fadeInDown" data-out="fadeOutUp">
			                <li class=" smooth-menu active"></li>
                          <li class=" smooth-menu"><a href="#ej2">Ejercicio 2</a></li>
			                </ul><!--/.nav -->
			            </div><!-- /.navbar-collapse -->
			        </div><!--/.container-->
			    </nav><!--/nav-->
			    <!-- End Navigation -->
			</div><!--/.header-area-->

		    <div class="clearfix"></div>

		</header><!-- /.top-area-->
		<!-- top-area End -->

		<!--welcome-hero start -->
		<section id="welcome-hero" class="welcome-hero">
			<div class="container">
				<div class="row">
					<div class="col-md-12 text-center">
						<div class="header-text">
							<h2>Estadística Computacional</h2>
							<p>Universidad de Granada</p>
						</div><!--/.header-text-->
					</div><!--/.col-->
				</div><!-- /.row-->
			</div><!-- /.container-->

		</section><!--/.welcome-hero-->
		<!--welcome-hero end -->

    <!--Ejercicio 2 start -->
		<section id="ej2" class="about">
			<div class="section-heading text-center">
				<h2>Ejercicio 2</h2>
			</div>
			<div class="container">
				<div class="about-content">
					<div class="row">
						<div class="single-about-txt">
              <h2><u><b>Enunciado</b></u></h2>
							<h3>
                R incluye una función generadora de números pseudoaleatorios de la distribución de Poisson, que está bien establecido que realiza la generación correctamente.
                Ahora bien, te ha llegado un escrito indicando que en el caso de que el parámetro lambda valga uno, no se generan correctamente.
                Especifica cómo podrías utilizar el contraste de ji cuadrado para tomar una decisión y hazlo.
                Añade los comentarios que estimes oportunos para justificar tu actuación.
							</h3>
              <h2><u><b>Solución</b></u></h2>
              <p>
                R posee una función para la generación de números pseudoaleatorios de la distribución de Poisson que es rpois, sospechamos de esta función luego nos dará
                la muestra con la que haremos el contraste. Para poder contrastar los datos no podemos partir de la generación de esta función por lo que obtendremos
                los valores esperados con la función dpois que es la que nos da la función de densidad de la distribución de Poisson.
              </p>
              <p>
                Por tanto el procedimiento será el siguiente. Estudiaremos en primer lugar los valores esperados usando la función dpois que sabemos que sí funciona
                bien con la distribución de Poisson con $\lambda=1$. Luego tomaremos una muestra de 1000 elementos con la función rpois que será la muestra que empleemos en
                el contraste. Cabe decir que la hipótesis nula es que el generador aleatorio funciona bien para $\lambda=1$ y que fijamos el $\alpha=0.05$.
              </p>
              <p>
                Recordemos que el contraste no funciona bien si no tenemos al menos 6 elementos esperados
                del número que estemos considerando.
              </p>
              <p>
                En primer lugar vamos a ver cómo se distribuye la función de densidad de la Poisson. Tengamos en cuenta que pretendemos
                tomar una muestra por ejemplo de tamaño 1000 para realizar el contraste.
              </p>
<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">val</span><span class="hl kwb">&lt;-</span><span class="hl kwd">dpois</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl opt">:</span><span class="hl num">10</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">)</span>
<span class="hl std">val</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] 3.678794e-01 3.678794e-01 1.839397e-01 6.131324e-02 1.532831e-02
##  [6] 3.065662e-03 5.109437e-04 7.299195e-05 9.123994e-06 1.013777e-06
## [11] 1.013777e-07
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">round</span><span class="hl std">(val</span><span class="hl opt">*</span><span class="hl num">1000</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] 368 368 184  61  15   3   1   0   0   0   0
</pre></div>
</div></div>
              <p>
                Como podemos ver hemos estudiado la distribución de probabilidad de los números
                del 0 al 10 con la distribución de Poisson. Como esperamos tomar una muestra de 1000 elementos
                he multiplicado las probabilidades obtenidas por 1000 para saber cuáles son los valores esperados de
                cada uno de los números del 0 al 10. Como se puede observar el número 5 sólo tiene un valor esperado de 3 por
                lo que no merece la pena considerar a partir de aquí los elementos por separados y debemos colapsarlos en una sola columna.
              </p>
<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">utiles</span><span class="hl kwb">&lt;-</span><span class="hl kwd">dpois</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl opt">:</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">)</span>
<span class="hl std">utiles</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.36787944 0.36787944 0.18393972 0.06131324
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">sum</span><span class="hl std">(utiles)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.9810118
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">esperados</span><span class="hl kwb">&lt;-</span><span class="hl kwd">c</span><span class="hl std">(utiles,</span><span class="hl num">1</span><span class="hl opt">-</span><span class="hl kwd">sum</span><span class="hl std">(utiles))</span>
<span class="hl std">esperados</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.36787944 0.36787944 0.18393972 0.06131324 0.01898816
</pre></div>
</div></div>
              <p>
                Para colapsar todos los valores por encima del 3 en una sola columna tenemos que saber cuánto vale la suma de las probabilidades
                de todos los elementos que sí hemos considerado como útiles por tener un número esperado de ocurrencias de al menos 6. En nuestro caso
                estos elementos útiles son desde el 0 hasta el 3, pues si incluyéramos el 4 entonces no obtendríamos siquiera 6 elementos esperados de valor mayor o igual a 5.
                Es por esto que nos conviene considerar de forma separada los valores desde el 0 hasta el 3 y colapsar en una sola columna del 4 en adelante. Como hemos obtenido
                que la suma de las probabilidades de los elementos desde el 0 hasta el 3 es de <code class="knitr inline">0.9810118</code> entonces la probabilidad de que salga un elemento mayor a
                3 es de <code class="knitr inline">0.0189882</code>
              </p>
              <p>
                Ahora podemos tomar la muestra de 1000 números de la Poisson con $\lambda=1$ con la que haremos el contraste de hipótesis.
              </p>
<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">muestra</span><span class="hl kwb">&lt;-</span><span class="hl kwd">rpois</span><span class="hl std">(</span><span class="hl num">1000</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">)</span>
<span class="hl kwd">table</span><span class="hl std">(muestra)</span>
</pre></div>
<div class="output"><pre class="knitr r">## muestra
##   0   1   2   3   4   5   6 
## 369 363 184  67  14   2   1
</pre></div>
</div></div>
              <p>
                Ahora viendo los datos obtenidos tenemos que hacer un vector con los valores esperados para el 0,1,2,3 y para 4 o más de 4 para colapsar todos estos valores en una sola columna.
              </p>
<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">tab</span><span class="hl kwb">&lt;-</span><span class="hl kwd">table</span><span class="hl std">(muestra)</span>
<span class="hl std">observados</span><span class="hl kwb">&lt;-</span><span class="hl kwd">c</span><span class="hl std">()</span>
<span class="hl std">i</span><span class="hl kwb">&lt;-</span><span class="hl num">1</span>
<span class="hl kwa">for</span><span class="hl std">(t</span> <span class="hl kwa">in</span> <span class="hl std">tab){</span>
  <span class="hl kwa">if</span><span class="hl std">(i</span><span class="hl opt">&lt;=</span><span class="hl num">5</span><span class="hl std">)</span>
    <span class="hl std">observados</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(observados,t)</span>
  <span class="hl kwa">else</span>
    <span class="hl std">observados[</span><span class="hl num">5</span><span class="hl std">]</span><span class="hl kwb">&lt;-</span><span class="hl std">observados[</span><span class="hl num">5</span><span class="hl std">]</span><span class="hl opt">+</span><span class="hl std">t</span>
  <span class="hl std">i</span><span class="hl kwb">&lt;-</span><span class="hl std">i</span><span class="hl opt">+</span><span class="hl num">1</span>
<span class="hl std">}</span>
<span class="hl std">observados</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 369 363 184  67  17
</pre></div>
</div></div>
              <p>
                Ahora que tenemos los valores observados <code class="knitr inline">369, 363, 184, 67, 17</code> y las probabilidades de los valores esperados <code class="knitr inline">0.3678794, 0.3678794, 0.1839397, 0.0613132, 0.0189882</code> podemos
                hacer el contraste de hipótesis con la hipótesis nula de que estamos seguros de que el generador de números aleatorios de la Poisson
                funciona bien para $\lambda=1$ y con $\alpha=0.05$.
                Hacemos el test:
              </p>
<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">res</span><span class="hl kwb">&lt;-</span><span class="hl kwd">chisq.test</span><span class="hl std">(observados,</span> <span class="hl kwc">p</span><span class="hl std">=esperados)</span>
<span class="hl std">res</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## 	Chi-squared test for given probabilities
## 
## data:  observados
## X-squared = 0.80377, df = 4, p-value = 0.9379
</pre></div>
</div></div>
              <p>
                El p-valor obtenido cuando hice la ejecución fue de 0.9289 con lo que, al ser mayor que 0.05 no rechazamos la hipótesis nula y por tanto
                seguimos creyendo que el generador de números aleatorios de la Poisson con $\lambda=1$ sigue funcionando correctamente.
              </p>
						</div>
					</div>
				</div>
			</div>
		</section><!--/.about-->
		<!--Ejercicio 2 end -->

		<!-- Include all js compiled plugins (below), or include individual files as needed -->

		<script src="assets/js/jquery.js"></script>

        <!--modernizr.min.js-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

		<!--bootstrap.min.js-->
        <script src="assets/js/bootstrap.min.js"></script>

		<!-- bootsnav js -->
		<script src="assets/js/bootsnav.js"></script>

		<!-- jquery.sticky.js -->
		<script src="assets/js/jquery.sticky.js"></script>

		<!-- for progress bar start-->

		<!-- progressbar js -->
		<script src="assets/js/progressbar.js"></script>

		<!-- appear js -->
		<script src="assets/js/jquery.appear.js"></script>

		<!-- for progress bar end -->

		<!--owl.carousel.js-->
        <script src="assets/js/owl.carousel.min.js"></script>


		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>


        <!--Custom JS-->
        <script src="assets/js/custom.js"></script>

    </body>

</html>
